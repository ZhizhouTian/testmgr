/*
 * Algorithm testing framework and tests.
 *
 * Copyright (c) 2002 James Morris <jmorris@intercode.com.au>
 * Copyright (c) 2002 Jean-Francois Dive <jef@linuxbe.org>
 * Copyright (c) 2007 Nokia Siemens Networks
 * Copyright (c) 2008 Herbert Xu <herbert@gondor.apana.org.au>
 *
 * Updated RFC4106 AES-GCM testing.
 *    Authors: Aidan O'Mahony (aidan.o.mahony@intel.com)
 *             Adrian Hoban <adrian.hoban@intel.com>
 *             Gabriele Paoloni <gabriele.paoloni@intel.com>
 *             Tadeusz Struk (tadeusz.struk@intel.com)
 *    Copyright (c) 2010, Intel Corporation.
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the Free
 * Software Foundation; either version 2 of the License, or (at your option)
 * any later version.
 *
 */

#include <crypto/aead.h>
#include <crypto/hash.h>
#include <crypto/skcipher.h>
#include <linux/err.h>
#include <linux/fips.h>
#include <linux/module.h>
#include <linux/scatterlist.h>
#include <linux/slab.h>
#include <linux/string.h>
#include <crypto/rng.h>
#include <crypto/drbg.h>
#include <crypto/akcipher.h>
#include <crypto/kpp.h>
#include <crypto/acompress.h>

/*
 * Need slab memory for testing (size in number of pages).
 */
#define XBUFSIZE	8
#define RSA_SIZE	512

struct tcrypt_result {
	struct completion completion;
	int err;
};

struct akcipher_testvec {
	const unsigned char *public_key;
	const unsigned char *private_key;
	const unsigned char *plain_text;
	unsigned int public_key_len;
	unsigned int private_key_len;
	unsigned int plain_text_size;
};

/*
 * RSA test vectors. Borrowed from openSSL.
 */
static const struct akcipher_testvec suite0 = {
	.private_key =
	"\x30\x82\x09\x29" /* sequence of 2345 bytes */
	"\x02\x01\x00" /* version integer of 1 byte */
	"\x02\x82\x02\x01" /* modulus - integer of 513 bytes */
	"\x00\xC3\x8B\x55\x7B\x73\x4D\xFF\xE9\x9B\xC6\xDC\x67\x3C\xB4\x8E"
	"\xA0\x86\xED\xF2\xB9\x50\x5C\x54\x5C\xBA\xE4\xA1\xB2\xA7\xAE\x2F"
	"\x1B\x7D\xF1\xFB\xAC\x79\xC5\xDF\x1A\x00\xC9\xB2\xC1\x61\x25\x33"
	"\xE6\x9C\xE9\xCF\xD6\x27\xC4\x4E\x44\x30\x44\x5E\x08\xA1\x87\x52"
	"\xCC\x6B\x97\x70\x8C\xBC\xA5\x06\x31\x0C\xD4\x2F\xD5\x7D\x26\x24"
	"\xA2\xE2\xAC\x78\xF4\x53\x14\xCE\xF7\x19\x2E\xD7\xF7\xE6\x0C\xB9"
	"\x56\x7F\x0B\xF1\xB1\xE2\x43\x70\xBD\x86\x1D\xA1\xCC\x2B\x19\x08"
	"\x76\xEF\x91\xAC\xBF\x20\x24\x0D\x38\xC0\x89\xB8\x9A\x70\xB3\x64"
	"\xD9\x8F\x80\x41\x10\x5B\x9F\xB1\xCB\x76\x43\x00\x21\x25\x36\xD4"
	"\x19\xFC\x55\x95\x10\xE4\x26\x74\x98\x2C\xD9\xBD\x0B\x2B\x04\xC2"
	"\xAC\x82\x38\xB4\xDD\x4C\x04\x7E\x51\x36\x40\x1E\x0B\xC4\x7C\x25"
	"\xDD\x4B\xB2\xE7\x20\x0A\x57\xF9\xB4\x94\xC3\x08\x33\x22\x6F\x8B"
	"\x48\xDB\x03\x68\x5A\x5B\xBA\xAE\xF3\xAD\xCF\xC3\x6D\xBA\xF1\x28"
	"\x67\x7E\x6C\x79\x07\xDE\xFC\xED\xE7\x96\xE3\x6C\xE0\x2C\x87\xF8"
	"\x02\x01\x28\x38\x43\x21\x53\x84\x69\x75\x78\x15\x7E\xEE\xD2\x1B"
	"\xB9\x23\x40\xA8\x86\x1E\x38\x83\xB2\x73\x1D\x53\xFB\x9E\x2A\x8A"
	"\xB2\x75\x35\x01\xC3\xC3\xC4\x94\xE8\x84\x86\x64\x81\xF4\x42\xAA"
	"\x3C\x0E\xD6\x4F\xBC\x0A\x09\x2D\xE7\x1B\xD4\x10\xA8\x54\xEA\x89"
	"\x84\x8A\xCB\xF7\x5A\x3C\xCA\x76\x08\x29\x62\xB4\x6A\x22\xDF\x14"
	"\x95\x71\xFD\xB6\x86\x39\xB8\x8B\xF8\x91\x7F\x38\xAA\x14\xCD\xE5"
	"\xF5\x1D\xC2\x6D\x53\x69\x52\x84\x7F\xA3\x1A\x5E\x26\x04\x83\x06"
	"\x73\x52\x56\xCF\x76\x26\xC9\xDD\x75\xD7\xFC\xF4\x69\xD8\x7B\x55"
	"\xB7\x68\x13\x53\xB9\xE7\x89\xC3\xE8\xD6\x6E\xA7\x6D\xEA\x81\xFD"
	"\xC4\xB7\x05\x5A\xB7\x41\x0A\x23\x8E\x03\x8A\x1C\xAE\xD3\x1E\xCE"
	"\xE3\x5E\xFC\x19\x4A\xEE\x61\x9B\x8E\xE5\xE5\xDD\x85\xF9\x41\xEC"
	"\x14\x53\x92\xF7\xDD\x06\x85\x02\x91\xE3\xEB\x6C\x43\x03\xB1\x36"
	"\x7B\x89\x5A\xA8\xEB\xFC\xD5\xA8\x35\xDC\x81\xD9\x5C\xBD\xCA\xDC"
	"\x9B\x98\x0B\x06\x5D\x0C\x5B\xEE\xF3\xD5\xCC\x57\xC9\x71\x2F\x90"
	"\x3B\x3C\xF0\x8E\x4E\x35\x48\xAE\x63\x74\xA9\xFC\x72\x75\x8E\x34"
	"\xA8\xF2\x1F\xEA\xDF\x3A\x37\x2D\xE5\x39\x39\xF8\x57\x58\x3C\x04"
	"\xFE\x87\x06\x98\xBC\x7B\xD3\x21\x36\x60\x25\x54\xA7\x3D\xFA\x91"
	"\xCC\xA8\x0B\x92\x8E\xB4\xF7\x06\xFF\x1E\x95\xCB\x07\x76\x97\x3B"
	"\x9D"
	"\x02\x03\x01\x00\x01" /* public key integer of 3 bytes */
	"\x02\x82\x02\x00" /* private key integer of 512 bytes */
	"\x74\xA9\xE0\x6A\x32\xB4\xCA\x85\xD9\x86\x9F\x60\x88\x7B\x40\xCC"
	"\xCD\x33\x91\xA8\xB6\x25\x1F\xBF\xE3\x51\x1C\x97\xB6\x2A\xD9\xB8"
	"\x11\x40\x19\xE3\x21\x13\xC8\xB3\x7E\xDC\xD7\x65\x40\x4C\x2D\xD6"
	"\xDC\xAF\x32\x6C\x96\x75\x2C\x2C\xCA\x8F\x3F\x7A\xEE\xC4\x09\xC6"
	"\x24\x3A\xC9\xCF\x6D\x8D\x17\x50\x94\x52\xD3\xE7\x0F\x2F\x7E\x94"
	"\x1F\xA0\xBE\xD9\x25\xE8\x38\x42\x7C\x27\xD2\x79\xF8\x2A\x87\x38"
	"\xEF\xBB\x74\x8B\xA8\x6E\x8C\x08\xC6\xC7\x4F\x0C\xBC\x79\xC6\xEF"
	"\x0E\xA7\x5E\xE4\xF8\x8C\x09\xC7\x5E\x37\xCC\x87\x77\xCD\xCF\xD1"
	"\x6D\x28\x1B\xA9\x62\xC0\xB8\x16\xA7\x8B\xF9\xBB\xCC\xB4\x15\x7F"
	"\x1B\x69\x03\xF2\x7B\xEB\xE5\x8C\x14\xD6\x23\x4F\x52\x6F\x18\xA6"
	"\x4B\x5B\x01\xAD\x35\xF9\x48\x53\xB3\x86\x35\x66\xD7\xE7\x29\xC0"
	"\x09\xB5\xC6\xE6\xFA\xC4\xDA\x19\xBE\xD7\x4D\x41\x14\xBE\x6F\xDF"
	"\x1B\xAB\xC0\xCA\x88\x07\xAC\xF1\x7D\x35\x83\x67\x28\x2D\x50\xE9"
	"\xCE\x27\x71\x5E\x1C\xCF\xD2\x30\x65\x79\x72\x2F\x9C\xE1\xD2\x39"
	"\x7F\xEF\x3B\x01\xF2\x14\x1D\xDF\xBD\x51\xD3\xA1\x53\x62\xCF\x5F"
	"\x79\x84\xCE\x06\x96\x69\x29\x49\x82\x1C\x71\x4A\xA1\x66\xC8\x2F"
	"\xFD\x7B\x96\x7B\xFC\xC4\x26\x58\xC4\xFC\x7C\xAF\xB5\xE8\x95\x83"
	"\x87\xCB\x46\xDE\x97\xA7\xB3\xA2\x54\x5B\xD7\xAF\xAB\xEB\xC8\xF3"
	"\x55\x9D\x48\x2B\x30\x9C\xDC\x26\x4B\xC2\x89\x45\x13\xB2\x01\x9A"
	"\xA4\x65\xC3\xEC\x24\x2D\x26\x97\xEB\x80\x8A\x9D\x03\xBC\x59\x66"
	"\x9E\xE2\xBB\xBB\x63\x19\x64\x93\x11\x7B\x25\x65\x30\xCD\x5B\x4B"
	"\x2C\xFF\xDC\x2D\x30\x87\x1F\x3C\x88\x07\xD0\xFC\x48\xCC\x05\x8A"
	"\xA2\xC8\x39\x3E\xD5\x51\xBC\x0A\xBE\x6D\xA8\xA0\xF6\x88\x06\x79"
	"\x13\xFF\x1B\x45\xDA\x54\xC9\x24\x25\x8A\x75\x0A\x26\xD1\x69\x81"
	"\x14\x14\xD1\x79\x7D\x8E\x76\xF2\xE0\xEB\xDD\x0F\xDE\xC2\xEC\x80"
	"\xD7\xDC\x16\x99\x92\xBE\xCB\x40\x0C\xCE\x7C\x3B\x46\xA2\x5B\x5D"
	"\x0C\x45\xEB\xE1\x00\xDE\x72\x50\xB1\xA6\x0B\x76\xC5\x8D\xFC\x82"
	"\x38\x6D\x99\x14\x1D\x1A\x4A\xD3\x7C\x53\xB8\x12\x46\xA2\x30\x38"
	"\x82\xF4\x96\x6E\x8C\xCE\x47\x0D\xAF\x0A\x3B\x45\xB7\x43\x95\x43"
	"\x9E\x02\x2C\x44\x07\x6D\x1F\x3C\x66\x89\x09\xB6\x1F\x06\x30\xCC"
	"\xAD\xCE\x7D\x9A\xDE\x3E\xFB\x6C\xE4\x58\x43\xD2\x4F\xA5\x9E\x5E"
	"\xA7\x7B\xAE\x3A\xF6\x7E\xD9\xDB\xD3\xF5\xC5\x41\xAF\xE6\x9C\x91"
	"\x02\x82\x01\x01" /* prime1 - integer of 257 bytes */
	"\x00\xE0\xA6\x6C\xF0\xA2\xF8\x81\x85\x36\x43\xD0\x13\x0B\x33\x8B"
	"\x8F\x78\x3D\xAC\xC7\x5E\x46\x6A\x7F\x05\xAE\x3E\x26\x0A\xA6\xD0"
	"\x51\xF3\xC8\x61\xF5\x77\x22\x48\x10\x87\x4C\xD5\xA4\xD5\xAE\x2D"
	"\x4E\x7A\xFE\x1C\x31\xE7\x6B\xFF\xA4\x69\x20\xF9\x2A\x0B\x99\xBE"
	"\x7C\x32\x68\xAD\xB0\xC6\x94\x81\x41\x75\xDC\x06\x78\x0A\xB4\xCF"
	"\xCD\x1B\x2D\x31\xE4\x7B\xEA\xA8\x35\x99\x75\x57\xC6\x0E\xF6\x78"
	"\x4F\xA0\x92\x4A\x00\x1B\xE7\x96\xF2\x5B\xFD\x2C\x0A\x0A\x13\x81"
	"\xAF\xCB\x59\x87\x31\xD9\x83\x65\xF2\x22\x48\xD0\x03\x67\x39\xF6"
	"\xFF\xA8\x36\x07\x3A\x68\xE3\x7B\xA9\x64\xFD\x9C\xF7\xB1\x3D\xBF"
	"\x26\x5C\xCC\x7A\xFC\xA2\x8F\x51\xD1\xE1\xE2\x3C\xEC\x06\x75\x7C"
	"\x34\xF9\xA9\x33\x70\x11\xAD\x5A\xDC\x5F\xCF\x50\xF6\x23\x2F\x39"
	"\xAC\x92\x48\x53\x4D\x01\x96\x3C\xD8\xDC\x1F\x23\x23\x78\x80\x34"
	"\x54\x14\x76\x8B\xB6\xBB\xFB\x88\x78\x31\x59\x28\xD2\xB1\x75\x17"
	"\x88\x04\x4A\x78\x62\x18\x2E\xF5\xFB\x9B\xEF\x15\xD8\x16\x47\xC6"
	"\x42\xB1\x02\xDA\x9E\xE3\x84\x90\xB4\x2D\xC3\xCE\x13\xC9\x12\x7D"
	"\x3E\xCD\x39\x39\xC9\xAD\xA1\x1A\xE6\xD5\xAD\x5A\x09\x4D\x1B\x0C"
	"\xAB"
	"\x02\x82\x01\x01" /* prime 2 - integer of 257 bytes */
	"\x00\xDE\xD5\x1B\xF6\xCD\x83\xB1\xC6\x47\x7E\xB9\xC0\x6B\xA9\xB8"
	"\x02\xF3\xAE\x40\x5D\xFC\xD3\xE5\x4E\xF1\xE3\x39\x04\x52\x84\x89"
	"\x40\x37\xBB\xC2\xCD\x7F\x71\x77\x17\xDF\x6A\x4C\x31\x24\x7F\xB9"
	"\x7E\x7F\xC8\x43\x4A\x3C\xEB\x8D\x1B\x7F\x21\x51\x67\x45\x8F\xA0"
	"\x36\x29\x3A\x18\x45\xA5\x32\xEC\x74\x88\x3C\x98\x5D\x67\x3B\xD7"
	"\x51\x1F\xE9\xAE\x09\x01\xDE\xDE\x7C\xFB\x60\xD1\xA5\x6C\xE9\x6A"
	"\x93\x04\x02\x3A\xBB\x67\x02\xB9\xFD\x23\xF0\x02\x2B\x49\x85\xC9"
	"\x5B\xE7\x4B\xDF\xA3\xF4\xEE\x59\x4C\x45\xEF\x8B\xC1\x6B\xDE\xDE"
	"\xBC\x1A\xFC\xD2\x76\x3F\x33\x74\xA9\x8E\xA3\x7E\x0C\xC6\xCE\x70"
	"\xA1\x5B\xA6\x77\xEA\x76\xEB\x18\xCE\xB9\xD7\x78\x8D\xAE\x06\xBB"
	"\xD3\x1F\x16\x0D\x05\xAB\x4F\xC6\x52\xC8\x6B\x36\x51\x7D\x1D\x27"
	"\xAF\x88\x9A\x6F\xCC\x25\x2E\x74\x06\x72\xCE\x9E\xDB\xE0\x9D\x30"
	"\xEF\x55\xA5\x58\x21\xA7\x42\x12\x2C\x2C\x23\x87\xC1\x0F\xE8\x51"
	"\xDA\x53\xDA\xFC\x05\x36\xDF\x08\x0E\x08\x36\xBE\x5C\x86\x9E\xCA"
	"\x68\x90\x33\x12\x0B\x14\x82\xAB\x90\x1A\xD4\x49\x32\x9C\xBD\xAA"
	"\xAB\x4E\x38\xF1\xEE\xED\x3D\x3F\xE8\xBD\x48\x56\xA6\x64\xEE\xC8"
	"\xD7"
	"\x02\x82\x01\x01" /* exponent 1 - integer of 257 bytes */
	"\x00\x96\x5E\x6F\x8F\x06\xD6\xE6\x03\x1F\x96\x76\x81\x38\xBF\x30"
	"\xCC\x40\x84\xAF\xD0\xE7\x06\xA5\x24\x0E\xCE\x59\xA5\x26\xFE\x0F"
	"\x74\xBB\x83\xC6\x26\x02\xAF\x3C\xA3\x6B\x9C\xFF\x68\x0C\xEB\x40"
	"\x42\x46\xCB\x2E\x5E\x2C\xF4\x3A\x32\x77\x77\xED\xAF\xBA\x02\x17"
	"\xE1\x93\xF0\x43\x4A\x8F\x31\x39\xEF\x72\x0F\x6B\x79\x10\x59\x84"
	"\xBA\x5A\x55\x7F\x0E\xDB\xEE\xEE\xD6\xA9\xB8\x44\x9F\x3A\xC6\xB9"
	"\x33\x3B\x5C\x90\x11\xD0\x9B\xCC\x8A\xBF\x0E\x10\x5B\x4B\xF1\x50"
	"\x9E\x35\xB3\xE0\x6D\x7A\x95\x9C\x38\x5D\xC0\x75\x13\xC2\x15\xA7"
	"\x81\xEA\xBA\xF7\x4D\x9E\x85\x9D\xF1\x7D\xBA\xD0\x45\x6F\x2A\xD0"
	"\x76\xC2\x28\xD0\xAD\xA7\xB5\xDC\xE3\x6A\x99\xFF\x83\x50\xB3\x75"
	"\x07\x14\x91\xAF\xEF\x74\xB5\x9F\x9A\xE0\xBA\xA9\x0B\x87\xF3\x85"
	"\x5C\x40\xB2\x0E\xA7\xFD\xC6\xED\x45\x8E\xD9\x7C\xB0\xB2\x68\xC6"
	"\x1D\xFD\x70\x78\x06\x41\x7F\x95\x12\x36\x9D\xE2\x58\x5D\x15\xEE"
	"\x41\x49\xF5\xFA\xEC\x56\x19\xA0\xE6\xE0\xB2\x40\xE1\xD9\xD0\x03"
	"\x22\x02\xCF\xD1\x3C\x07\x38\x65\x8F\x65\x0E\xAA\x32\xCE\x25\x05"
	"\x16\x73\x51\xB9\x9F\x88\x0B\xCD\x30\xF3\x97\xCC\x2B\x6B\xA4\x0E"
	"\x6F"
	"\x02\x82\x01\x00" /* exponent 2 - integer of 256 bytes */
	"\x2A\x5F\x3F\xB8\x08\x90\x58\x47\xA9\xE4\xB1\x11\xA3\xE7\x5B\xF4"
	"\x43\xBE\x08\xC3\x56\x86\x3C\x7E\x6C\x84\x96\x9C\xF9\xCB\xF6\x05"
	"\x5E\x13\xB8\x11\x37\x80\xAD\xF2\xBE\x2B\x0A\x5D\xF5\xE0\xCB\xB7"
	"\x00\x39\x66\x82\x41\x5F\x51\x2F\xBF\x56\xE8\x91\xC8\xAA\x6C\xFE"
	"\x9F\x8C\x4A\x7D\x43\xD2\x91\x1F\xFF\x9F\xF6\x21\x1C\xB6\x46\x55"
	"\x48\xCA\x38\xAB\xC1\xCD\x4D\x65\x5A\xAF\xA8\x6D\xDA\x6D\xF0\x34"
	"\x10\x79\x14\x0D\xFA\xA2\x8C\x17\x54\xB4\x18\xD5\x7E\x5F\x90\x50"
	"\x87\x84\xE7\xFB\xD7\x61\x53\x5D\xAB\x96\xC7\x6E\x7A\x42\xA0\xFC"
	"\x07\xED\xB7\x5F\x80\xD9\x19\xFF\xFB\xFD\x9E\xC4\x73\x31\x62\x3D"
	"\x6C\x9E\x15\x03\x62\xA5\x85\xCC\x19\x8E\x9D\x7F\xE3\x6D\xA8\x5D"
	"\x96\xF5\xAC\x78\x3D\x81\x27\xE7\x29\xF1\x29\x1D\x09\xBB\x77\x86"
	"\x6B\x65\x62\x88\xE1\x31\x1A\x22\xF7\xC5\xCE\x73\x65\x1C\xBE\xE7"
	"\x63\xD3\xD3\x14\x63\x27\xAF\x28\xF3\x23\xB6\x76\xC1\xBD\x9D\x82"
	"\xF4\x9B\x19\x7D\x2C\x57\xF0\xC2\x2A\x51\xAE\x95\x0D\x8C\x38\x54"
	"\xF5\xC6\xA0\x51\xB7\x0E\xB9\xEC\xE7\x0D\x22\xF6\x1A\xD3\xFE\x16"
	"\x21\x03\xB7\x0D\x85\xD3\x35\xC9\xDD\xE4\x59\x85\xBE\x7F\xA1\x75"
	"\x02\x82\x01\x01" /* coefficient - integer of 257 bytes */
	"\x00\xB9\x48\xD2\x54\x2F\x19\x54\x64\xAE\x62\x80\x61\x89\x80\xB4"
	"\x48\x0B\x8D\x7E\x1B\x0F\x50\x08\x82\x3F\xED\x75\x84\xB7\x13\xE4"
	"\xF8\x8D\xA8\xBB\x54\x21\x4C\x5A\x54\x07\x16\x4B\xB4\xA4\x9E\x30"
	"\xBF\x7A\x30\x1B\x39\x60\xA3\x21\x53\xFB\xB0\xDC\x0F\x7C\x2C\xFB"
	"\xAA\x95\x7D\x51\x39\x28\x33\x1F\x25\x31\x53\xF5\xD2\x64\x2B\xF2"
	"\x1E\xB3\xC0\x6A\x0B\xC9\xA4\x42\x64\x5C\xFB\x15\xA3\xE8\x4C\x3A"
	"\x9C\x3C\xBE\xA3\x39\x83\x23\xE3\x6D\x18\xCC\xC2\xDC\x63\x8D\xBA"
	"\x98\xE0\xE0\x31\x4A\x2B\x37\x9C\x4D\x6B\xF3\x9F\x51\xE4\x43\x5C"
	"\x83\x5F\xBF\x5C\xFE\x92\x45\x01\xAF\xF5\xC2\xF4\xB7\x56\x93\xA5"
	"\xF4\xAA\x67\x3C\x48\x37\xBD\x9A\x3C\xFE\xA5\x9A\xB0\xD1\x6B\x85"
	"\xDD\x81\xD4\xFA\xAD\x31\x83\xA8\x22\x9B\xFD\xB4\x61\xDC\x7A\x51"
	"\x59\x62\x10\x1B\x7E\x44\xA3\xFE\x90\x51\x5A\x3E\x02\x87\xAD\xFA"
	"\xDD\x0B\x1F\x3D\x35\xAF\xEE\x13\x85\x51\xA7\x42\xC0\xEE\x9E\x20"
	"\xE9\xD0\x29\xB2\xE4\x21\xE4\x6D\x62\xB9\xF4\x48\x4A\xD8\x46\x8E"
	"\x61\xA6\x2C\x5D\xDF\x8F\x97\x2B\x3A\x75\x1D\x83\x17\x6F\xC6\xB0"
	"\xDE\xFC\x14\x25\x06\x5A\x60\xBB\xB8\x21\x89\xD1\xEF\x57\xF1\x71"
	"\x3D",
	.plain_text = "\x55\x85\x9b\x34\x2c\x49\xea\x2a",
	.private_key_len = 2349,
	.plain_text_size = 8,
};

static const struct akcipher_testvec suite1 = {
	.private_key = 
	/* total key length */
	"\x30\x82\x09\x2a"
	/* version */
	"\x02\x01\x00"
	/* module length */
	"\x02\x82\x02\x01"
	/* module */
	"\x00\xb7\x76\x32\x97\x16\xf0\xd1\x1f\x9f\x8b\x34\x35\xa5\xb1\x39"
	"\x42\x32\x84\xb1\x7c\x2d\xea\xcf\x4c\x93\xcb\xd6\x56\x3c\xde\x41"
	"\xa1\x42\xcb\x49\xb8\xc4\xb4\x3c\x92\xed\xe1\xdd\x12\x35\xc4\xf1"
	"\xa5\x67\x8d\x68\x9b\x38\x84\xcb\xa4\x00\x2c\xec\x24\x32\x94\x97"
	"\xe4\x66\x46\x74\xf8\xdd\xef\x76\xc2\x24\x84\xed\xb7\x97\x2f\xb1"
	"\xdc\x63\x74\x4c\xb7\xd9\x0c\x7d\x7e\x8b\x60\x86\xdb\xd6\x25\xf5"
	"\x81\xee\x7e\x38\x63\x84\xe0\x30\x6d\x57\x7f\xeb\x25\x62\xaa\x12"
	"\xfc\xb1\x21\x86\x05\x11\x7b\x46\x7b\x55\xdb\x32\x67\x05\xc6\xa2"
	"\xb3\x6e\x04\x5c\x7a\xb4\x7d\x52\x89\xc7\x90\x25\xd5\xee\x24\xdb"
	"\x98\x81\x08\x25\x47\x86\x9d\x74\x33\x87\x21\xef\x24\xda\xef\xd5"
	"\xe0\xa3\x14\x00\xa4\x3b\x1e\x13\xe3\xab\x15\x75\x8f\x0b\x3e\xa0"
	"\x2d\x2d\x91\x51\x40\x83\x59\xba\x8b\x81\x82\xb6\x49\x3b\x8e\x54"
	"\x28\x64\x27\x49\xfb\x1e\x1a\x39\x39\x2d\x59\x75\x3e\x64\xc8\xb4"
	"\x51\x51\x8f\x92\xf4\xbc\x68\x1d\x7d\x1e\x44\xfc\x63\xd7\x6e\x3e"
	"\x4d\x0c\xb5\x91\xa8\xc2\x94\xef\x36\x4e\x93\x8e\x7e\xe7\xc4\x66"
	"\x2d\x67\x7a\x95\xbe\x7e\xc1\xb3\xfe\xae\xed\xfd\x55\x2d\xd0\xdb"
	"\xbc\x4c\x02\xaa\xf6\x95\x65\xa8\xf3\x2b\xf8\x82\xf1\x2e\x35\xcd"
	"\x53\xac\x88\xee\x92\xe8\xca\xcd\x7a\x2e\xc6\xae\x99\xf9\xc1\x6a"
	"\xf1\xb1\x9e\xce\xee\xce\x35\xd3\x3e\x2b\x1c\xcd\x8c\xcc\x7a\xb6"
	"\x7c\xb3\xc7\x2b\xea\xb3\x5b\xe3\x43\x6e\xdd\xdd\x4d\x18\x59\xab"
	"\xf4\x13\x1d\x3b\xa1\x57\x43\x33\xb5\xd2\xc1\x3b\x37\xc1\xd4\xd7"
	"\x58\x3a\xb4\x6a\x6f\x48\x6d\x9c\x84\x1c\xdd\x6c\xa3\x42\x13\x38"
	"\x97\xbe\xd7\xbf\x0f\x38\xe7\x6b\xe1\x65\xd7\xc3\xad\x47\xba\x9a"
	"\x65\x0b\x56\x09\x2a\x29\x8c\xee\xe2\x3b\xa8\x0d\xeb\x75\x74\xd3"
	"\xfb\x31\x10\x22\x5c\x28\x88\xd5\x2d\x0f\xf1\xaf\xe9\xa1\xf6\xa7"
	"\xe7\xe5\xc3\xb0\x5e\xaf\x8c\xda\xa3\xc2\x06\x14\x15\xc6\x56\x10"
	"\x5d\x43\xf6\x2e\x5a\xfe\x24\xba\x32\x73\xcc\x4c\x12\xf8\x0f\x24"
	"\x00\xeb\xdf\x81\xdb\x8e\x98\xfa\x4a\x92\x30\x9c\x21\xa9\x23\x26"
	"\x69\xc3\x45\x6c\xd2\xe1\x4a\xd0\x81\x0c\x11\x12\x93\x96\xdf\xf0"
	"\x7a\xde\x16\x6f\xe9\x89\xb2\x62\x2d\x68\xe5\xe3\x48\x33\xe6\x8e"
	"\x43\x3e\x1b\x62\x52\x14\xfd\x8a\xed\x8f\xd9\x64\x7c\x11\x5a\xfb"
	"\x7d\x78\x1e\x85\x73\x1e\x9f\xc8\x75\x09\x24\xd4\x74\x24\x4f\x1f"
	"\x8d"
	/* public key */
	"\x02\x03\x01\x00\x01"
	/* private key length */
	"\x02\x82\x02\x00"
	/* private key */
	"\x58\x59\xc2\xa9\x42\x71\xfc\xb3\xd6\xf8\x89\xcf\x20\x19\x45\xf2"
	"\xdc\x33\x4c\xe9\xf9\x8e\xef\xff\xf7\xd9\x1d\x42\x70\x93\xb4\x55"
	"\x7d\xbe\x3a\xa5\x91\x8d\x1e\xf2\xbf\x3e\x9b\x61\x2e\xa5\xc6\x9d"
	"\x9a\x4d\xde\x47\x8a\x23\x61\x92\x7c\x47\x25\xfd\x94\xa2\x3c\xb7"
	"\xd0\x8d\x33\xbd\xb9\xdb\x9d\x7c\x87\x6b\xc0\xb3\x3e\x4a\xc8\xc3"
	"\xd2\xdd\x6a\x28\xcb\x8d\x19\x4e\x7c\xbe\xa2\x93\x72\x00\xdb\xc7"
	"\x93\xdc\x13\x39\xd1\xfe\xc9\x33\x8f\x04\xda\x70\x29\xa0\xaf\xfe"
	"\x23\x2b\x7a\xc8\x2c\x10\x0a\xf4\x50\x77\x7c\x41\x62\xe5\xb2\xea"
	"\xe8\x1b\x8f\x91\xc4\x23\xea\x40\xd1\xeb\x58\x5d\x3b\x0f\x62\xf5"
	"\x81\x86\x33\xb5\xcb\x5d\x3e\x5d\xa6\x41\x30\x52\xb6\x60\xf3\xc5"
	"\xf7\xa3\x25\x5f\xf1\xdc\x5d\x45\xb1\xd9\x66\xc0\xd9\x70\x72\x60"
	"\xef\x65\xe1\x14\x49\x6d\x47\xc9\xf1\x37\xca\xa3\x5f\xdb\xfe\x29"
	"\x69\x7a\x06\x45\xb9\xcc\x75\x2c\x54\xeb\x94\xeb\xd4\x4b\x57\x93"
	"\x25\xcd\x17\xbf\x66\x90\x59\x4b\x2c\xed\x9a\x02\x56\xf8\x0f\x66"
	"\xb9\xad\x23\x15\x7b\x87\x8f\xdf\xbe\x5d\x8f\x2d\x0c\x5e\x67\xba"
	"\x8b\xef\xdb\xf7\x5e\x41\xd8\x75\xd9\x36\x61\x5e\xc8\xee\xa1\x32"
	"\xae\x6e\x27\x03\xf2\x6b\x70\x95\xd1\xc6\x28\x75\x6a\x21\xe5\x99"
	"\xdc\xe6\xf4\x3d\xd6\xff\x9e\x4d\x60\xdd\x2e\x57\xff\x5b\x6b\x73"
	"\xe9\xd6\xda\x50\x7f\xb7\x50\x48\x8a\x9c\x8d\x01\xe6\x46\xea\x04"
	"\x27\x88\xdf\x7a\xbc\x1a\xc8\x1c\x94\x50\xdc\x94\x2f\x6c\x26\xd8"
	"\x5b\xc4\x2d\xeb\xf9\x21\x82\xb6\x73\x41\x2b\xcc\x12\x1d\x1c\xdf"
	"\x11\xe3\x0f\xe4\xd5\xf2\x12\x9c\x6b\x36\x87\xa8\x5c\x1d\x2d\x0a"
	"\xfd\xd7\x1e\x1d\x5e\x98\xd2\xe7\xef\xd3\xe8\xe3\xf1\x65\x0d\x07"
	"\x7d\x87\x89\x02\xfa\xc1\x45\xef\x34\x1c\x0f\x1a\xb0\x7b\xc3\x41"
	"\xa2\x89\xc8\x46\x42\x78\xd4\x94\xef\xee\x55\xc4\x00\x47\xb4\x05"
	"\x3a\xfc\x48\x5f\x16\x06\xec\x9f\x82\xfd\x14\x46\xfb\x34\x1c\xee"
	"\x74\xb1\x56\x51\xfa\x96\xa4\x1c\x9e\x24\xab\x3f\x78\x63\x7b\xe7"
	"\x69\x01\x0d\xac\x5f\x0a\xc3\x55\x6a\xfc\x30\x38\x98\x3b\x59\x29"
	"\x07\x7a\xed\xc5\xd2\xd8\xce\x8a\x31\x2a\xa3\x43\xd6\xbf\xc4\x11"
	"\x46\xe4\x25\x10\x60\xb7\x80\x55\x0d\x48\x22\xc6\x89\x67\x04\x8f"
	"\x53\x6f\x30\x94\xb7\xd5\x8f\xee\x8c\x1e\x48\xbb\xb2\x2e\x8f\x4e"
	"\xbc\x49\x73\xe1\x0a\x81\x47\x2e\x79\xf1\x9b\x23\x0b\x35\x4a\xc1"
	""
	/* prime1 length */
	"\x02\x82\x01\x01"
	/* prime1 */
	"\x00\xed\x34\x9c\x4d\x66\x98\x84\x11\x13\x9c\xcc\x55\x47\xdd\x32"
	"\xe0\x7f\x73\x30\x5a\x71\xcc\xc8\x85\x4f\x8e\xe2\x28\x3d\x9c\xba"
	"\x05\x04\x0b\xee\x59\xa5\x2a\x83\xeb\xd6\xdd\x54\x44\x31\x01\x56"
	"\xac\x71\xd3\x3f\xae\xf8\x7a\x52\x8f\x95\x80\x18\xed\x7d\x89\x1c"
	"\xef\x8e\x17\xcb\x3f\x10\x09\xe2\x38\x63\x58\x3f\x2e\xbb\xbb\xed"
	"\x1a\x3b\x1a\x00\x2c\x15\xf5\xf9\xf3\xae\x0b\x74\x3b\x66\xb1\xcc"
	"\xd7\x38\x26\x14\x9c\x17\xc2\x65\xcb\x4d\x74\xc7\xcf\xd7\x37\x36"
	"\xea\x7c\xa8\x52\x09\xa6\x6e\xa1\xad\xed\x33\xf0\xa7\xa4\x08\x38"
	"\xe6\x83\x29\xc0\xcb\x95\x67\x26\xcc\xd9\x31\xc1\xf4\x92\x78\xcb"
	"\x7c\xb6\x88\x90\x1e\x71\x45\x99\x77\xda\xc5\x77\x8e\x1a\x54\xd7"
	"\x3a\x46\x21\xd5\x8c\xa3\x1c\x5f\x78\x1c\xc6\x1e\x92\x1c\x97\xdc"
	"\x0a\x37\x93\xea\x4f\x58\x14\xeb\xa8\xba\xab\xce\x4e\x01\xd2\x57"
	"\xbc\xeb\x55\x09\x02\x1d\x4b\x48\x35\xcb\xa5\x45\x47\x9c\xaa\x68"
	"\xfd\xdb\xab\xbf\x9e\xad\x2f\x83\xdc\x2b\x83\x19\x5b\x87\xb8\x3c"
	"\xd9\x92\x11\x8e\x9f\x45\x48\xdd\xbc\x73\xda\xf7\x2d\xa6\x53\x6d"
	"\x54\x73\x5f\xd1\x52\x1c\xd2\xa7\x0b\x34\xea\x2c\xa0\x45\x91\xd7"
	"\xfd"
	/* prime1 length */
	"\x02\x82\x01\x01"
	/* prime2 */
	"\x00\xc5\xff\x77\xb1\x67\x74\x99\xf1\x6a\x18\x84\x82\x54\x08\x49"
	"\xa1\x8f\x77\xd4\xe0\x85\x39\x4d\x5f\xc0\xbd\x46\xae\x05\x36\xe4"
	"\xf4\xa6\x27\x60\x95\x77\xe3\x26\xa2\xf8\xe5\xe3\x47\x33\xa6\xba"
	"\xeb\x37\x0d\x11\x50\x2a\x6a\x43\x49\x1b\xfd\x1d\x2c\xe2\x8a\x3b"
	"\x52\x44\xf4\x3a\xba\x00\x51\xbe\x1d\xd3\xed\x98\x69\x1c\x58\x56"
	"\x52\xce\x4b\x2d\x84\x99\x83\x83\x76\x29\x71\xe2\x9c\x90\xdd\xb3"
	"\x5b\x67\x60\x1f\x9f\x0b\xd7\xc4\x94\xe2\x81\x33\x5d\x11\x70\xe6"
	"\x48\xef\xa6\x0f\xe0\x5c\xab\x3a\xbb\x27\xf4\x90\x10\xdb\xb6\xba"
	"\x8e\xb2\xea\xdc\x2c\xa9\x7e\x5e\x47\x63\xa2\xa4\x64\xb4\x29\x3b"
	"\xce\xce\xa1\x2d\xdd\xe6\x1f\xf9\x78\xee\x60\x9d\xcb\x7a\x6f\x9d"
	"\xd7\x78\x70\xf3\x82\x88\x39\x40\x69\xad\xe8\xe8\xba\x09\x60\x4a"
	"\x97\xb4\xac\x39\x67\xa0\x13\x2d\x76\x31\x48\x06\x48\x73\xc9\x01"
	"\x51\xa4\xab\x01\x05\xab\xa2\x88\x91\xda\xc5\x9f\x6a\x60\xda\x36"
	"\xc7\xe0\x79\xca\xcd\xcf\xc4\xf5\x6e\x14\x19\x14\xc5\x18\xa1\xdf"
	"\x1f\x42\x5c\x49\x3b\x4b\xe3\x1b\x7c\xf3\x0a\x98\x58\x4c\x5d\xe7"
	"\x6c\x24\x83\xe9\x68\x6c\x78\x58\x8c\x38\x45\xdf\x70\xfd\xa6\x12"
	"\xd1"
	/* exponent1 length */
	"\x02\x82\x01\x01"
	/* exponent1 */
	"\x00\x81\x48\x26\x54\x4d\x31\x9c\xf1\x4d\xb6\x2c\xeb\xe2\x12\x1e"
	"\x33\x9b\x63\x25\x9c\x75\xdf\xbd\xfe\x62\x81\x26\xa3\xf6\x08\xa0"
	"\x9e\x31\x39\x6b\x7b\xf2\x78\x3c\x94\x62\x74\x19\x04\x5d\x8d\x34"
	"\x37\x22\x86\x97\x73\xfe\xbb\x74\x9a\x0b\x4a\x58\xcb\xbf\x9a\xe6"
	"\x69\x6e\x11\x6b\xd6\x00\x20\xd2\xea\x16\xc3\x37\x14\x7a\x7f\x8f"
	"\x57\xb7\x94\x91\x39\x75\xf2\xad\x7b\x71\x85\x8e\xa0\xfd\x74\xb4"
	"\x87\x2c\x74\x1c\xd1\x82\x65\x92\x63\x7e\xe0\xc2\x32\x76\x43\x02"
	"\xac\x44\xaa\xdc\xa3\xa3\xd1\x32\x4f\x80\x33\xc9\xdb\x24\x9c\xd2"
	"\x9e\x58\x28\x7e\x8a\xb6\xf0\x14\x86\x9b\x6d\xf2\x1f\x21\x61\xb2"
	"\xce\x53\x12\x15\x32\x72\x5c\x13\xab\xee\x51\xa7\xba\x8c\x81\x67"
	"\x18\xbc\xb6\x9e\x14\x5b\xa6\x10\x26\x7f\xd0\x3f\x43\x35\x50\x53"
	"\x3e\x42\x52\x5c\xe7\x47\xc3\x87\x39\x5c\x1c\x5d\x81\xc8\x9e\x62"
	"\xf1\x75\x75\xd0\x46\x15\xbf\x3d\x29\x0c\xc8\x13\xfd\x56\xd6\xce"
	"\x08\x66\x1c\xb2\x80\x82\x35\x9e\x71\x76\x49\xaa\x9d\x67\x58\x33"
	"\xda\x05\x31\x8a\x81\x26\x1a\xf3\xb7\x4d\x91\xaf\x1c\x73\x45\x8f"
	"\x15\xf3\x17\xeb\x17\x0c\xdc\x86\xec\xa5\xb7\x68\x01\x26\x49\xb9"
	"\xe5"
	/* exponent2 length */
	"\x02\x82\x01\x01"
	/* exponent2 */
	"\x00\x83\xc3\xd5\x85\xec\x51\x7e\xb9\x58\x5f\xe4\x9f\x4f\x09\x0c"
	"\xe7\x45\xb0\xfb\xac\x47\x3c\xb1\x2f\x4d\xf7\x28\x78\x5a\xe4\x03"
	"\x4e\x84\xdc\xa3\xbc\x14\xc2\xc8\x4d\xa0\xd2\x6c\x84\x4f\xed\x5f"
	"\x6b\x75\x81\x6e\xca\x28\xcf\xfa\xe3\x46\x8b\x15\xc5\x6f\x25\x8b"
	"\x00\xde\xfe\xa1\xae\x72\xd3\xf3\x6f\xaa\x3f\xee\x33\xd5\x37\x3c"
	"\x8b\x72\xda\x38\xfa\x8b\xa7\x27\xef\x94\xf9\x43\x53\xea\x5c\x80"
	"\x26\x0e\x0f\xbc\x3b\x7e\x08\x23\xbc\xe9\x58\x0e\x34\x9b\x8c\xc4"
	"\xd4\x39\x18\x0c\x6c\xc5\x7e\xf6\x60\xe2\xe0\x30\x97\xe7\x80\x1d"
	"\x7b\x25\xba\x82\xb7\xfe\x3c\x28\xc5\xdd\x9a\xb9\x48\x83\x55\x05"
	"\x86\x45\xa0\xa2\x03\x90\x48\x2b\x1f\xbd\x93\xf2\xaf\x1d\x55\xf6"
	"\x77\x14\xa2\x26\x8b\xf1\xd8\x17\xf3\xbc\x56\xc9\xba\x34\xcf\x2e"
	"\x14\xf3\x99\xc1\xc2\x22\x97\x60\xa3\xcd\x7c\x1f\x22\x4c\x5b\xb2"
	"\x53\x01\x01\x04\x77\x1f\x97\xd4\xc7\x2c\x0e\x64\x5e\xc9\x01\xaf"
	"\x7f\x28\xf6\x24\x6e\xff\x1c\x16\x31\x21\x92\xe7\x6d\x9b\x4c\xee"
	"\x4d\xc1\x3d\xe5\x46\x5e\xe4\x4e\xc0\xc2\x85\x84\x89\x0e\x99\x57"
	"\x8f\x72\x65\x8f\x09\x7d\x56\x41\xa7\x5f\x33\xb0\xd5\x63\x18\x08"
	"\x61"
	/* coefficient length */
	"\x02\x82\x01\x01"
	/* coefficient */
	"\x00\xac\x46\xab\x01\x53\x2b\xb6\xbc\x72\xcb\x42\xba\xe3\xa4\x34"
	"\xed\x1f\x1e\x0d\x4b\x05\xbb\x5c\x18\xa3\x4f\x32\x7e\x1c\x02\x93"
	"\x18\x61\x45\x25\x70\xe5\xca\x41\xba\xe0\xfa\x53\xaa\xc2\x11\x2b"
	"\xb2\x3d\xa0\x12\xab\x30\x71\x41\xfc\x5d\x0d\x08\xc2\x8f\xdd\x52"
	"\x3b\x35\xd8\x8f\x07\x51\x56\x4a\x3e\x60\xfa\xb0\xf8\xb3\x93\x25"
	"\x8b\xd6\x0d\xef\xc9\x31\x65\xaf\xbe\x2b\xfe\xf1\xcb\xbd\x67\xe8"
	"\xd1\x5d\x27\x10\xa7\x7f\x15\x5c\x94\x90\x11\x47\x97\x94\xaa\xfa"
	"\x3e\x8e\xc4\x21\x54\x6a\x91\xc0\x80\xe7\x94\x50\x93\x94\xbe\x4c"
	"\x1f\x12\xb5\x25\x91\xa3\x47\xaf\xc6\xd0\x2b\x49\x10\x2b\xc6\x77"
	"\x67\x49\x7e\x9e\xab\x81\x2b\x46\x5e\x8e\x54\xad\x7f\x0b\x17\x37"
	"\xe0\xb1\x78\x50\x13\xd4\x29\xdf\x57\x58\x2e\x0e\xf2\x8b\x40\xfe"
	"\xf6\x69\x48\x27\xf1\xde\x91\x4e\x17\xcb\xd7\x75\x28\x4f\x76\x88"
	"\x1b\x53\xb3\xae\x0f\x31\x2f\xd6\x15\x5c\x4f\x23\xfa\xe8\x3b\xe2"
	"\x8c\x7c\xc1\xce\x48\xa8\x20\x6b\x55\xb9\x84\x27\x41\x21\x97\x07"
	"\x62\xa1\x9b\xc6\x9c\xa9\x33\xea\x50\x6c\xf6\xf1\x90\x37\x73\x58"
	"\x0e\x79\xdc\x00\x58\xf7\x3c\x68\xb5\xdd\xb8\x74\x17\xbd\x0d\xe4"
	"\x60",
	.private_key_len = 2350,
	.public_key =
	"\x30\x82\x02\x22\x30\x0d\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x01"
	"\x01\x05\x00\x03\x82\x02\x0f\x00\x30\x82\x02\x0a\x02\x82\x02\x01"
	"\x00\xb7\x76\x32\x97\x16\xf0\xd1\x1f\x9f\x8b\x34\x35\xa5\xb1\x39"
	"\x42\x32\x84\xb1\x7c\x2d\xea\xcf\x4c\x93\xcb\xd6\x56\x3c\xde\x41"
	"\xa1\x42\xcb\x49\xb8\xc4\xb4\x3c\x92\xed\xe1\xdd\x12\x35\xc4\xf1"
	"\xa5\x67\x8d\x68\x9b\x38\x84\xcb\xa4\x00\x2c\xec\x24\x32\x94\x97"
	"\xe4\x66\x46\x74\xf8\xdd\xef\x76\xc2\x24\x84\xed\xb7\x97\x2f\xb1"
	"\xdc\x63\x74\x4c\xb7\xd9\x0c\x7d\x7e\x8b\x60\x86\xdb\xd6\x25\xf5"
	"\x81\xee\x7e\x38\x63\x84\xe0\x30\x6d\x57\x7f\xeb\x25\x62\xaa\x12"
	"\xfc\xb1\x21\x86\x05\x11\x7b\x46\x7b\x55\xdb\x32\x67\x05\xc6\xa2"
	"\xb3\x6e\x04\x5c\x7a\xb4\x7d\x52\x89\xc7\x90\x25\xd5\xee\x24\xdb"
	"\x98\x81\x08\x25\x47\x86\x9d\x74\x33\x87\x21\xef\x24\xda\xef\xd5"
	"\xe0\xa3\x14\x00\xa4\x3b\x1e\x13\xe3\xab\x15\x75\x8f\x0b\x3e\xa0"
	"\x2d\x2d\x91\x51\x40\x83\x59\xba\x8b\x81\x82\xb6\x49\x3b\x8e\x54"
	"\x28\x64\x27\x49\xfb\x1e\x1a\x39\x39\x2d\x59\x75\x3e\x64\xc8\xb4"
	"\x51\x51\x8f\x92\xf4\xbc\x68\x1d\x7d\x1e\x44\xfc\x63\xd7\x6e\x3e"
	"\x4d\x0c\xb5\x91\xa8\xc2\x94\xef\x36\x4e\x93\x8e\x7e\xe7\xc4\x66"
	"\x2d\x67\x7a\x95\xbe\x7e\xc1\xb3\xfe\xae\xed\xfd\x55\x2d\xd0\xdb"
	"\xbc\x4c\x02\xaa\xf6\x95\x65\xa8\xf3\x2b\xf8\x82\xf1\x2e\x35\xcd"
	"\x53\xac\x88\xee\x92\xe8\xca\xcd\x7a\x2e\xc6\xae\x99\xf9\xc1\x6a"
	"\xf1\xb1\x9e\xce\xee\xce\x35\xd3\x3e\x2b\x1c\xcd\x8c\xcc\x7a\xb6"
	"\x7c\xb3\xc7\x2b\xea\xb3\x5b\xe3\x43\x6e\xdd\xdd\x4d\x18\x59\xab"
	"\xf4\x13\x1d\x3b\xa1\x57\x43\x33\xb5\xd2\xc1\x3b\x37\xc1\xd4\xd7"
	"\x58\x3a\xb4\x6a\x6f\x48\x6d\x9c\x84\x1c\xdd\x6c\xa3\x42\x13\x38"
	"\x97\xbe\xd7\xbf\x0f\x38\xe7\x6b\xe1\x65\xd7\xc3\xad\x47\xba\x9a"
	"\x65\x0b\x56\x09\x2a\x29\x8c\xee\xe2\x3b\xa8\x0d\xeb\x75\x74\xd3"
	"\xfb\x31\x10\x22\x5c\x28\x88\xd5\x2d\x0f\xf1\xaf\xe9\xa1\xf6\xa7"
	"\xe7\xe5\xc3\xb0\x5e\xaf\x8c\xda\xa3\xc2\x06\x14\x15\xc6\x56\x10"
	"\x5d\x43\xf6\x2e\x5a\xfe\x24\xba\x32\x73\xcc\x4c\x12\xf8\x0f\x24"
	"\x00\xeb\xdf\x81\xdb\x8e\x98\xfa\x4a\x92\x30\x9c\x21\xa9\x23\x26"
	"\x69\xc3\x45\x6c\xd2\xe1\x4a\xd0\x81\x0c\x11\x12\x93\x96\xdf\xf0"
	"\x7a\xde\x16\x6f\xe9\x89\xb2\x62\x2d\x68\xe5\xe3\x48\x33\xe6\x8e"
	"\x43\x3e\x1b\x62\x52\x14\xfd\x8a\xed\x8f\xd9\x64\x7c\x11\x5a\xfb"
	"\x7d\x78\x1e\x85\x73\x1e\x9f\xc8\x75\x09\x24\xd4\x74\x24\x4f\x1f"
	"\x8d\x02\x03\x01\x00\x01",
	.public_key_len = 550,
	.plain_text = "\x55\x85\x9b\x34\x2c\x49\xea\x2a",
	.plain_text_size = 8,
};

static void hexdump(const unsigned char *buf, unsigned int len)
{
	print_hex_dump(KERN_CONT, "", DUMP_PREFIX_OFFSET,
			16, 1,
			buf, len, false);
}

static void tcrypt_complete(struct crypto_async_request *req, int err)
{
	struct tcrypt_result *res = req->data;

	if (err == -EINPROGRESS)
		return;

	res->err = err;
	complete(&res->completion);
}

static int testmgr_alloc_buf(char *buf[XBUFSIZE])
{
	int i;

	for (i = 0; i < XBUFSIZE; i++) {
		buf[i] = (void *)__get_free_page(GFP_KERNEL);
		if (!buf[i])
			goto err_free_buf;
	}

	return 0;

err_free_buf:
	while (i-- > 0)
		free_page((unsigned long)buf[i]);

	return -ENOMEM;
}

static void testmgr_free_buf(char *buf[XBUFSIZE])
{
	int i;

	for (i = 0; i < XBUFSIZE; i++)
		free_page((unsigned long)buf[i]);
}

static int wait_async_op(struct tcrypt_result *tr, int ret)
{
	if (ret == -EINPROGRESS || ret == -EBUSY) {
		wait_for_completion(&tr->completion);
		reinit_completion(&tr->completion);
		ret = tr->err;
	}
	return ret;
}

static int rsa_encrypto(struct crypto_akcipher *tfm,
		const unsigned char *private_key, const unsigned char *plain_text, 
		unsigned int private_key_len, unsigned int plain_text_size, void **outbuf_enc_ret)
{
	char *xbuf[XBUFSIZE];
	struct akcipher_request *req;
	void *outbuf_enc = NULL;
	struct tcrypt_result result;
	unsigned int out_len_max = 0;
	int err = -ENOMEM;
	struct scatterlist dst, src_tab[2];

	if (testmgr_alloc_buf(xbuf))
		return err;

	req = akcipher_request_alloc(tfm, GFP_KERNEL);
	if (!req)
		goto free_xbuf;

	init_completion(&result.completion);

	/*
	if (vecs->public_key_vec)
		err = crypto_akcipher_set_pub_key(tfm, vecs->private_key, vecs->private_key_len);
	else
	*/
	err = crypto_akcipher_set_priv_key(tfm, private_key, private_key_len);
	if (err)
		goto free_req;

	err = -ENOMEM;
	out_len_max = crypto_akcipher_maxsize(tfm);
	outbuf_enc = kzalloc(out_len_max, GFP_KERNEL);
	if (!outbuf_enc)
		goto free_req;

	if (WARN_ON(plain_text_size > PAGE_SIZE))
		goto free_all;

	pr_info("Paintext:\n");
	hexdump(plain_text, plain_text_size);
	memcpy(xbuf[0], plain_text, plain_text_size);

	sg_init_table(src_tab, 2);
	sg_set_buf(&src_tab[0], xbuf[0], 8);
	sg_set_buf(&src_tab[1], xbuf[0] + 8, plain_text_size - 8);
	sg_init_one(&dst, outbuf_enc, out_len_max);
	akcipher_request_set_crypt(req, src_tab, &dst, plain_text_size, out_len_max);
	akcipher_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,
				      tcrypt_complete, &result);

#if 0
	/* Run asymmetric signature generation */
	crypto_akcipher_sign(req)
#endif

	/* Run asymmetric encrypt */
	err = wait_async_op(&result, crypto_akcipher_encrypt(req));
	if (err) {
		pr_err("alg: akcipher: encrypt test failed. err %d\n", err);
		goto free_all;
	}
	/*
	if (req->dst_len != c_size) {
		pr_err("alg: akcipher: encrypt test failed. Invalid output len\n");
		err = -EINVAL;
		goto free_all;
	}
	*/
	/* verify that encrypted message is equal to expected */
	/*
	if (memcmp(c, outbuf_enc, c_size)) {
		pr_err("alg: akcipher: encrypt test failed. Invalid output\n");
		hexdump(outbuf_enc, c_size);
		err = -EINVAL;
		goto free_all;
	}
	*/
	/* Don't invoke decrypt for vectors with public key */
	/*
	if (vecs->public_key_vec) {
		err = 0;
		goto free_all;
	}
	*/
	*outbuf_enc_ret = outbuf_enc;

	akcipher_request_free(req);
	testmgr_free_buf(xbuf);
	return 0;

free_all:
	kfree(outbuf_enc);
free_req:
	akcipher_request_free(req);
free_xbuf:
	testmgr_free_buf(xbuf);
	return err;
}

static int rsa_decrypto(struct crypto_akcipher *tfm,
		const unsigned char *private_key, unsigned int private_key_len,
		void *outbuf_enc, void **outbuf_dec_ret)
{
	char *xbuf[XBUFSIZE];
	struct akcipher_request *req;
	void *outbuf_dec = NULL;
	struct tcrypt_result result;
	unsigned int out_len_max, out_len = 0;
	int err = 0;
	struct scatterlist src, dst, src_tab[2];

	if (testmgr_alloc_buf(xbuf))
		return err;

	req = akcipher_request_alloc(tfm, GFP_KERNEL);
	if (!req)
		goto free_xbuf;

	init_completion(&result.completion);

	err = crypto_akcipher_set_priv_key(tfm, private_key, private_key_len);
	if (err)
		goto free_req;

	out_len_max = crypto_akcipher_maxsize(tfm);
	outbuf_dec = kzalloc(out_len_max, GFP_KERNEL);
	if (!outbuf_dec) {
		err = -ENOMEM;
		goto free_all;
	}

	memcpy(xbuf[0], outbuf_enc, RSA_SIZE);

	sg_init_table(src_tab, 2);
	sg_set_buf(&src_tab[0], xbuf[0], 8);
	sg_init_one(&src, xbuf[0], RSA_SIZE);
	sg_init_one(&dst, outbuf_dec, out_len_max);
	akcipher_request_set_crypt(req, &src, &dst, RSA_SIZE, out_len_max);
	akcipher_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,
				      tcrypt_complete, &result);

	/* Run asymmetric decrypt */
	err = wait_async_op(&result, crypto_akcipher_decrypt(req));

#if 0
	/* Run asymmetric signature verification */
	crypto_akcipher_verify(req) :
#endif
				     
	if (err) {
		pr_err("alg: akcipher: decrypt test failed. err %d\n", err);
		goto free_all;
	}
	out_len = req->dst_len;
	/*
	if (out_len < plain_text_size) {
		pr_err("alg: akcipher: decrypt test failed. "
		       "Invalid output len %u\n", out_len);
		err = -EINVAL;
		goto free_all;
	}
	*/
	/* verify that decrypted message is equal to the original msg */
	/*
	if (memchr_inv(outbuf_dec, 0, out_len - vecs->plain_text_size) ||
	    memcmp(vecs->plain_text, outbuf_dec + out_len - vecs->plain_text_size,
		   vecs->plain_text_size)) {
		pr_err("alg: akcipher: decrypt test failed. Invalid output\n");
		hexdump(outbuf_dec, out_len);
		err = -EINVAL;
	}
	*/

	akcipher_request_free(req);
	testmgr_free_buf(xbuf);

	*outbuf_dec_ret = outbuf_dec;
	return 0;

free_all:
	kfree(outbuf_dec);
free_req:
	akcipher_request_free(req);
free_xbuf:
	testmgr_free_buf(xbuf);
	return err;
}

static __init int alg_test_init(void)
{
	struct crypto_akcipher *tfm;
	int err = 0;
	const char* driver = "rsa-generic";
	u32 type = 0, mask = 0;
	void *outbuf_enc = NULL;
	void *outbuf_dec = NULL;
	const char *algo = NULL;
	const struct akcipher_testvec *suite = &suite1;

	tfm = crypto_alloc_akcipher(driver, type, mask);
	if (IS_ERR(tfm)) {
		pr_err("Failed to load for %s: %ld\n", driver, PTR_ERR(tfm));
		return PTR_ERR(tfm);
	}
	algo = crypto_tfm_alg_driver_name(crypto_akcipher_tfm(tfm));
	pr_info("Start %s encrypto and decrypto\n", algo);

	err = rsa_encrypto(tfm, suite->private_key, suite->plain_text, suite->private_key_len, suite->plain_text_size, &outbuf_enc);
	if (err) {
		pr_err("Failed to do encrypto\n");
		return err;
	}

	pr_info("Show encryp buffer:\n");
	hexdump(outbuf_enc, RSA_SIZE);

	err = rsa_decrypto(tfm, suite->private_key, suite->private_key_len, outbuf_enc, &outbuf_dec);
	if (err) {
		pr_err("Failed to do decrypto\n");
		return err;
	}
	pr_info("Show decryp buffer:\n");
	hexdump(outbuf_dec, RSA_SIZE);

	pr_info("suite private key length:%lu\n", sizeof(suite->private_key));
	kfree(outbuf_enc);
	kfree(outbuf_dec);

	crypto_free_akcipher(tfm);
	return err;
}

static __exit void alg_test_exit(void)
{

}

module_init(alg_test_init);
module_exit(alg_test_exit);

MODULE_LICENSE("GPL");
